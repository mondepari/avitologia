# Инструкции по развертыванию проекта

Этот проект настроен для развертывания с использованием Docker. Ниже приведены инструкции для различных сценариев развертывания.

## Быстрое развертывание с Docker

Самый простой способ запустить проект — использовать Docker и предоставленные скрипты:

1. Клонируйте репозиторий:
   ```bash
   git clone <url-репозитория>
   cd <название-проекта>
   ```

2. Запустите скрипт быстрого старта:
   ```bash
   ./start.sh
   ```

Этот скрипт автоматически:
- Создаст файл `.env` из примера `.env.example` (если он не существует)
- Запустит контейнеры Docker через `docker-compose`
- Отобразит статус запущенных контейнеров

После завершения, приложение будет доступно по адресу: `http://localhost:5000`.

## Подробное развертывание

Для более детального контроля над процессом развертывания, следуйте пошаговой инструкции:

### 1. Подготовка

```bash
# Клонирование репозитория
git clone <url-репозитория>
cd <название-проекта>

# Создание файла .env
cp .env.example .env

# Редактирование параметров окружения (при необходимости)
nano .env
```

### 2. Запуск с Docker Compose

```bash
# Запуск контейнеров в фоновом режиме
docker-compose up -d

# Проверка статуса
docker-compose ps

# Просмотр логов
docker-compose logs -f
```

### 3. Остановка и удаление контейнеров

```bash
# Остановка контейнеров
docker-compose down

# Остановка контейнеров и удаление томов (данных)
docker-compose down -v
```

## Обновление проекта

Для обновления уже развернутого проекта:

```bash
# Получить последние изменения
git pull

# Запустить скрипт обновления
./update.sh
```

Скрипт `update.sh` автоматически:
- Получит последние изменения из Git-репозитория
- Создаст резервную копию базы данных
- Пересоберет и перезапустит контейнеры
- Отобразит статус обновленных контейнеров

## Развертывание в продакшн

Для продакшн-окружения рекомендуется:

1. Изменить учетные данные базы данных в `.env`
2. Раскомментировать и настроить Nginx-сервис в `docker-compose.yml`
3. Настроить SSL-сертификаты для Nginx

Дополнительную информацию можно найти в файле [DOCKER_GUIDE.md](DOCKER_GUIDE.md).

## Устранение неисправностей

Если у вас возникли проблемы при развертывании:

1. Проверьте логи контейнеров:
   ```bash
   docker-compose logs
   ```

2. Убедитесь, что все необходимые порты свободны:
   ```bash
   netstat -tulpn | grep 5000
   ```

3. Проверьте подключение к базе данных:
   ```bash
   docker-compose exec app node -e "const { Pool } = require('pg'); const pool = new Pool({connectionString: process.env.DATABASE_URL}); pool.query('SELECT NOW()', (err, res) => { console.log(err, res); pool.end(); });"
   ```

Более подробную информацию о Docker вы можете найти в [официальной документации Docker](https://docs.docker.com/).